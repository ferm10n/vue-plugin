/*!
* rete-vue-plugin v2.0.4
* (c) 2024 Vitaliy Stoliarov
* Released under the MIT license.
* */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("rete"),require("vue"),require("rete-render-utils"),require("rete-area-plugin")):"function"==typeof define&&define.amd?define(["exports","rete","vue","rete-render-utils","rete-area-plugin"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).ReteVuePlugin={},t.Rete,t.Vue,t.ReteRenderUtils,t.ReteAreaPlugin)}(this,(function(t,e,n,r,o){"use strict";function i(t){if(!t)return;if("undefined"==typeof window)return;const e=document.createElement("style");return e.setAttribute("type","text/css"),e.innerHTML=t,document.head.appendChild(e),t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){p(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function s(){s=function(){return t};var t={},e=Object.prototype,n=e.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function l(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(t){l=function(t,e,n){return t[e]=n}}function u(t,e,n,o){var i=e&&e.prototype instanceof f?e:f,a=Object.create(i.prototype),c=new E(o||[]);return r(a,"_invoke",{value:x(t,n,c)}),a}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var p={};function f(){}function h(){}function v(){}var m={};l(m,i,(function(){return this}));var b=Object.getPrototypeOf,y=b&&b(b(O([])));y&&y!==e&&n.call(y,i)&&(m=y);var g=v.prototype=f.prototype=Object.create(m);function w(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function k(t,e){function o(r,i,a,c){var s=d(t[r],t,i);if("throw"!==s.type){var l=s.arg,u=l.value;return u&&"object"==typeof u&&n.call(u,"__await")?e.resolve(u.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(u).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,c)}))}c(s.arg)}var i;r(this,"_invoke",{value:function(t,n){function r(){return new e((function(e,r){o(t,n,e,r)}))}return i=i?i.then(r,r):r()}})}function x(t,e,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return S()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var c=_(a,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var s=d(t,e,n);if("normal"===s.type){if(r=n.done?"completed":"suspendedYield",s.arg===p)continue;return{value:s.arg,done:n.done}}"throw"===s.type&&(r="completed",n.method="throw",n.arg=s.arg)}}}function _(t,e){var n=e.method,r=t.iterator[n];if(void 0===r)return e.delegate=null,"throw"===n&&t.iterator.return&&(e.method="return",e.arg=void 0,_(t,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var o=d(r,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,p;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,p):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,p)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function B(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function O(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,o=function e(){for(;++r<t.length;)if(n.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:S}}function S(){return{value:void 0,done:!0}}return h.prototype=v,r(g,"constructor",{value:v,configurable:!0}),r(v,"constructor",{value:h,configurable:!0}),h.displayName=l(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,l(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},w(k.prototype),l(k.prototype,a,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},w(g),l(g,c,"Generator"),l(g,i,(function(){return this})),l(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},t.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(B),!t)for(var e in this)"t"===e.charAt(0)&&n.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function r(n,r){return a.type="throw",a.arg=t,e.next=n,r&&(e.method="next",e.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),s=n.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),p},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),B(n),p}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;B(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:O(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},t}function l(t){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l(t)}function u(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,w(r.key),r)}}function p(t,e,n){return(e=w(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f(t){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},f(t)}function h(t,e){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},h(t,e)}function v(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=f(t);if(e){var o=f(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return function(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}(this,n)}}function b(){return b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,n){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=f(t)););return t}(t,e);if(r){var o=Object.getOwnPropertyDescriptor(r,e);return o.get?o.get.call(arguments.length<3?t:n):o.value}},b.apply(this,arguments)}function y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return a=t.done,t},e:function(t){c=!0,i=t},f:function(){try{a||null==n.return||n.return()}finally{if(c)throw i}}}}function w(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}function k(){var t=new Map;return{get:function(e){return t.get(e)},mount:function(e,r,o,i){var a=function(t,e,r,o){var i=n.ref(n.markRaw(r)),a=n.createApp({render:function(){return n.h(e,c(c({},i.value),{},{seed:Math.random()}))},mounted:function(){o()},updated:function(){o()}});return a.mount(t),{app:a,payload:i}}(e,r,o,i);return t.set(e,a),a},update:function(t,e){!function(t,e){t.payload.value=n.markRaw(c(c({},t.payload.value),e))}(t,e)},unmount:function(e){var n=t.get(e);n&&(n.app.unmount(),t.delete(e))}}}const x={"data-testid":"connection"},_=["d"];i("/*! https://github.com/retejs/connection-plugin/commit/206ca0fd7fb82801ac45a0f7180ae05dff9ed901 */\nsvg[data-v-fee8858e] {\n  overflow: visible !important;\n  position: absolute;\n  pointer-events: none;\n  width: 9999px;\n  height: 9999px;\n}\nsvg[data-v-fee8858e] path[data-v-fee8858e] {\n  fill: none;\n  stroke-width: 5px;\n  stroke: steelblue;\n  pointer-events: auto;\n}");var P=(t,e)=>{const n=t.__vccOpts||t;for(const[t,r]of e)n[t]=r;return n};var B=P(n.defineComponent({props:["data","start","end","path"]}),[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("svg",x,[n.createElementVNode("path",{d:t.path},null,8,_)])}],["__scopeId","data-v-fee8858e"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/classic/components/Connection.vue"]]);var E=P(n.defineComponent({props:["component","data","start","end","path"],data:()=>({observedStart:{x:0,y:0},observedEnd:{x:0,y:0},observedPath:"",onDestroy:null}),computed:{startPosition(){return this.start&&"x"in this.start?this.start:this.observedStart},endPosition(){return this.end&&"x"in this.end?this.end:this.observedEnd}},watch:{startPosition(){this.fetchPath()},endPosition(){this.fetchPath()}},methods:{async fetchPath(){this.startPosition&&this.endPosition&&(this.observedPath=await this.path(this.startPosition,this.endPosition))}},created(){const t="function"==typeof this.start&&this.start((t=>{this.observedStart=t})),e="function"==typeof this.end&&this.end((t=>{this.observedEnd=t}));this.onDestroy=()=>{t&&t(),e&&e()}},destroyed(){this.onDestroy&&this.onDestroy()}}),[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createBlock(n.resolveDynamicComponent(t.component),{data:t.data,start:t.startPosition,end:t.endPosition,path:t.observedPath},null,8,["data","start","end","path"])}],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/classic/components/ConnectionWrapper.vue"]]);const O=["type","value","readonly"];i("input[data-v-a4adbbb3] {\n  width: 100%;\n  border-radius: 30px;\n  background-color: white;\n  padding: 2px 6px;\n  border: 1px solid #999;\n  font-size: 110%;\n  box-sizing: border-box;\n}");var S=P(n.defineComponent({props:["data"],methods:{change(t){const e="number"===this.data.type?+t.target.value:t.target.value;this.data.setValue(e)}}}),[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("input",{type:t.data.type,value:t.data.value,readonly:t.data.readonly,onInput:e[0]||(e[0]=(...e)=>t.change&&t.change(...e)),onPointerdown:e[1]||(e[1]=n.withModifiers((()=>{}),["stop"]))},null,40,O)}],["__scopeId","data-v-a4adbbb3"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/classic/components/Control.vue"]]);var j=P(n.defineComponent({props:["data","emit"],mounted(){this.emit({type:"render",data:{...this.data,element:this.$refs.element}})},beforeDestroy(){this.emit({type:"unmount",data:{element:this.$refs.element}})},beforeUnmount(){this.emit({type:"unmount",data:{element:this.$refs.element}})}}),[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("div",n.mergeProps(t.$props,{ref:"element"}),null,16)}],["__file","/home/runner/work/vue-plugin/vue-plugin/src/Ref.vue"]]);function C(t){return t.sort(((t,e)=>(t[1]&&t[1].index||0)-(e[1]&&e[1].index||0))),t}var L=n.defineComponent({props:["data","emit","seed"],methods:{nodeStyles(){return{width:Number.isFinite(this.data.width)?`${this.data.width}px`:"",height:Number.isFinite(this.data.height)?`${this.data.height}px`:""}},inputs(){return C(Object.entries(this.data.inputs))},controls(){return C(Object.entries(this.data.controls))},outputs(){return C(Object.entries(this.data.outputs))}},components:{Ref:j}});const z={class:"title","data-testid":"title"},N=["data-testid"],I={class:"output-title","data-testid":"output-title"},M=["data-testid"];i(".node[data-v-cc6bc301] {\n  background: rgba(110, 136, 255, 0.8);\n  border: 2px solid #4e58bf;\n  border-radius: 10px;\n  cursor: pointer;\n  box-sizing: border-box;\n  width: 180px;\n  height: auto;\n  padding-bottom: 6px;\n  position: relative;\n  user-select: none;\n  line-height: initial;\n  font-family: Arial;\n}\n.node[data-v-cc6bc301][data-v-cc6bc301]:hover {\n  background: rgba(130, 153, 255, 0.8);\n}\n.node[data-v-cc6bc301].selected[data-v-cc6bc301] {\n  background: #ffd92c;\n  border-color: #e3c000;\n}\n.node[data-v-cc6bc301] .title[data-v-cc6bc301] {\n  color: white;\n  font-family: sans-serif;\n  font-size: 18px;\n  padding: 8px;\n}\n.node[data-v-cc6bc301] .output[data-v-cc6bc301] {\n  text-align: right;\n}\n.node[data-v-cc6bc301] .input[data-v-cc6bc301] {\n  text-align: left;\n}\n.node[data-v-cc6bc301] .output-socket[data-v-cc6bc301] {\n  text-align: right;\n  margin-right: -18px;\n  display: inline-block;\n}\n.node[data-v-cc6bc301] .input-socket[data-v-cc6bc301] {\n  text-align: left;\n  margin-left: -18px;\n  display: inline-block;\n}\n.node[data-v-cc6bc301] .input-title[data-v-cc6bc301],\n.node[data-v-cc6bc301] .output-title[data-v-cc6bc301] {\n  vertical-align: middle;\n  color: white;\n  display: inline-block;\n  font-family: sans-serif;\n  font-size: 14px;\n  margin: 6px;\n  line-height: 24px;\n}\n.node[data-v-cc6bc301] .input-control[data-v-cc6bc301] {\n  z-index: 1;\n  width: calc(100% - 36px);\n  vertical-align: middle;\n  display: inline-block;\n}\n.node[data-v-cc6bc301] .control[data-v-cc6bc301] {\n  padding: 6px 18px;\n}");var D=P(L,[["render",function(t,e,r,o,i,a){const c=n.resolveComponent("Ref");return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["node",{selected:t.data.selected}]),style:n.normalizeStyle(t.nodeStyles()),"data-testid":"node"},[n.createElementVNode("div",z,n.toDisplayString(t.data.label),1),n.createCommentVNode(" Outputs"),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(t.outputs(),(([e,r])=>(n.openBlock(),n.createElementBlock("div",{class:"output",key:"output"+e+t.seed,"data-testid":"output-"+e},[n.createElementVNode("div",I,n.toDisplayString(r.label),1),n.createVNode(c,{class:"output-socket",data:{type:"socket",side:"output",key:e,nodeId:t.data.id,payload:r.socket},emit:t.emit,"data-testid":"output-socket"},null,8,["data","emit"])],8,N)))),128)),n.createCommentVNode(" Controls"),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(t.controls(),(([e,r])=>(n.openBlock(),n.createBlock(c,{class:"control",key:"control"+e+t.seed,"data-testid":"control-"+e,emit:t.emit,data:{type:"control",payload:r}},null,8,["data-testid","emit","data"])))),128)),n.createCommentVNode(" Inputs"),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(t.inputs(),(([e,r])=>(n.openBlock(),n.createElementBlock("div",{class:"input",key:"input"+e+t.seed,"data-testid":"input-"+e},[n.createVNode(c,{class:"input-socket",data:{type:"socket",side:"input",key:e,nodeId:t.data.id,payload:r.socket},emit:t.emit,"data-testid":"input-socket"},null,8,["data","emit"]),n.withDirectives(n.createElementVNode("div",{class:"input-title","data-testid":"input-title"},n.toDisplayString(r.label),513),[[n.vShow,!r.control||!r.showControl]]),n.withDirectives(n.createVNode(c,{class:"input-control",emit:t.emit,data:{type:"control",payload:r.control},"data-testid":"input-control"},null,8,["emit","data"]),[[n.vShow,r.control&&r.showControl]])],8,M)))),128))],6)}],["__scopeId","data-v-cc6bc301"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/classic/components/Node.vue"]]);const V=["title"];i(".socket[data-v-4a0a4b7f] {\n  display: inline-block;\n  cursor: pointer;\n  border: 1px solid white;\n  border-radius: 12px;\n  width: 24px;\n  height: 24px;\n  margin: 6px;\n  vertical-align: middle;\n  background: #96b38a;\n  z-index: 2;\n  box-sizing: border-box;\n}\n.socket[data-v-4a0a4b7f][data-v-4a0a4b7f]:hover {\n  border-width: 4px;\n}\n.socket[data-v-4a0a4b7f].multiple[data-v-4a0a4b7f] {\n  border-color: yellow;\n}\n.socket[data-v-4a0a4b7f].output[data-v-4a0a4b7f] {\n  margin-right: -12px;\n}\n.socket[data-v-4a0a4b7f].input[data-v-4a0a4b7f] {\n  margin-left: -12px;\n}");var R=P({props:["data"]},[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("div",{class:"socket",title:r.data.name},null,8,V)}],["__scopeId","data-v-4a0a4b7f"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/classic/components/Socket.vue"]]);var $=Object.freeze({__proto__:null,setup:function(t){var n=void 0===(null==t?void 0:t.socketPositionWatcher)?r.getDOMSocketPosition():null==t?void 0:t.socketPositionWatcher,o=(null==t?void 0:t.customize)||{},i=o.node,a=o.connection,l=o.socket,d=o.control;return{attach:function(t){n.attach(t)},update:function(t,e){var n=t.data.payload,r=e.parentScope();if(!r)throw new Error("parent");var o=r.emit.bind(r);if("node"===t.data.type)return{data:n,emit:o};if("connection"===t.data.type){var i=t.data,a=i.start,s=i.end;return c(c({data:n},a?{start:a}:{}),s?{end:s}:{})}return{data:n}},render:function(t,o){var c,p,f=o.parentScope(),h=f.emit.bind(f);if("node"===t.data.type){var v=i?i(t.data):D;return v&&{component:v,props:{data:t.data.payload,emit:h}}}if("connection"===t.data.type){var m=a?a(t.data):B,b=t.data.payload,y=b.source,g=b.target,w=b.sourceOutput,k=b.targetInput;return m&&{component:E,props:{data:t.data.payload,component:m,start:t.data.start||function(t){return n.listen(y,"output",w,t)},end:t.data.end||function(t){return n.listen(g,"input",k,t)},path:(c=s().mark((function t(e,n){var i,a,c,l,u;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o.emit({type:"connectionpath",data:{payload:b,points:[e,n]}});case 2:if(i=t.sent){t.next=5;break}return t.abrupt("return","");case 5:if(a=i.data,c=a.path,l=a.points,u=.3,c||2===l.length){t.next=9;break}throw new Error("cannot render connection with a custom number of points");case 9:if(c){t.next=11;break}return t.abrupt("return",b.isLoop?r.loopConnectionPath(l,u,120):r.classicConnectionPath(l,u));case 11:return t.abrupt("return",c);case 12:case"end":return t.stop()}}),t)})),p=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=c.apply(t,e);function i(t){u(o,n,r,i,a,"next",t)}function a(t){u(o,n,r,i,a,"throw",t)}i(void 0)}))},function(t,e){return p.apply(this,arguments)})}}}if("socket"===t.data.type){var x=t.data.payload;return{component:l?l(t.data):R,props:{data:x}}}if("control"===t.data.type){var _=t.data.payload;if(d){var P=d(t.data);return P&&{component:P,props:{data:_}}}return t.data.payload instanceof e.ClassicPreset.InputControl?{component:S,props:{data:_}}:null}}}},Connection:B,Control:S,Node:D,Socket:R});const T={class:"block"};i(".block[data-v-e9c17765] {\n  color: #fff;\n  padding: 4px;\n  border-bottom: 1px solid rgba(69, 103, 255, 0.8);\n  background-color: rgba(110, 136, 255, 0.8);\n  cursor: pointer;\n  box-sizing: border-box;\n  width: 100%;\n  position: relative;\n}\n.block[data-v-e9c17765][data-v-e9c17765]:first-child {\n  border-top-left-radius: 5px;\n  border-top-right-radius: 5px;\n}\n.block[data-v-e9c17765][data-v-e9c17765]:last-child {\n  border-bottom-left-radius: 5px;\n  border-bottom-right-radius: 5px;\n}\n.block[data-v-e9c17765][data-v-e9c17765]:hover {\n  background-color: rgba(130, 153, 255, 0.8);\n}");var F=P({},[["render",function(t,e){return n.openBlock(),n.createElementBlock("div",T,[n.renderSlot(t.$slots,"default",{},void 0,!0)])}],["__scopeId","data-v-e9c17765"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/context-menu/components/Block.vue"]]);const A=["value"];i(".search[data-v-3253b3e6] {\n  color: white;\n  padding: 1px 8px;\n  border: 1px solid white;\n  border-radius: 10px;\n  font-size: 16px;\n  font-family: serif;\n  width: 100%;\n  box-sizing: border-box;\n  background: transparent;\n}");var W=P(n.defineComponent({props:["text"]}),[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("input",{class:"search",value:t.text,onInput:e[0]||(e[0]=e=>t.$emit("change",e.target.value)),"data-testid":"context-menu-search-input"},null,40,A)}],["__scopeId","data-v-3253b3e6"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/context-menu/components/Search.vue"]]);function H(t,e){return{timeout:null,cancel:function(){this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)},call:function(){this.timeout=window.setTimeout((function(){e()}),t)}}}const G={key:0,class:"subitems"};i('@charset "UTF-8";\n.block[data-v-fc3b2bca] {\n  padding: 0;\n}\n\n.content[data-v-fc3b2bca] {\n  padding: 4px;\n}\n\n.hasSubitems[data-v-fc3b2bca][data-v-fc3b2bca]:after {\n  content: "►";\n  position: absolute;\n  opacity: 0.6;\n  right: 5px;\n  top: 5px;\n}\n\n.subitems[data-v-fc3b2bca] {\n  position: absolute;\n  top: 0;\n  left: 100%;\n  width: 120px;\n}');var q=P({name:"Item",props:["subitems","delay"],data(){return{visibleSubitems:!1,hide:H(this.delay,this.hideSubitems)}},methods:{hideSubitems(){this.visibleSubitems=!1}},components:{Block:F}},[["render",function(t,e,r,o,i,a){const c=n.resolveComponent("Item",!0),s=n.resolveComponent("Block");return n.openBlock(),n.createBlock(s,{class:n.normalizeClass(["block",{hasSubitems:r.subitems}]),"data-testid":"context-menu-item"},{default:n.withCtx((()=>[n.createElementVNode("div",{class:"content",onClick:e[1]||(e[1]=n.withModifiers((e=>{t.$emit("select",e),t.$emit("hide")}),["stop"])),onWheel:e[2]||(e[2]=n.withModifiers((()=>{}),["stop"])),onPointerover:e[3]||(e[3]=t=>{i.hide.cancel(),i.visibleSubitems=!0}),onPointerleave:e[4]||(e[4]=t=>i.hide.call()),onPointerdown:e[5]||(e[5]=n.withModifiers((()=>{}),["stop"]))},[n.renderSlot(t.$slots,"default",{},void 0,!0),r.subitems&&i.visibleSubitems?(n.openBlock(),n.createElementBlock("div",G,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.subitems,(o=>(n.openBlock(),n.createBlock(c,{key:o.key,onSelect:t=>o.handler(t),delay:r.delay,onHide:e[0]||(e[0]=e=>t.$emit("hide")),subitems:o.subitems},{default:n.withCtx((()=>[n.createTextVNode(n.toDisplayString(o.label),1)])),_:2},1032,["onSelect","delay","subitems"])))),128))])):n.createCommentVNode("v-if",!0)],32)])),_:3},8,["class"])}],["__scopeId","data-v-fc3b2bca"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/context-menu/components/Item.vue"]]);i(".menu[data-v-2571168d] {\n  padding: 10px;\n  width: 120px;\n  margin-top: -20px;\n  margin-left: -60px;\n}");var U=P(n.defineComponent({props:["items","delay","searchBar","onHide","seed"],data(){return{filter:"",hide:H(this.delay,this.onHide)}},methods:{getItems(){const t=new RegExp(this.filter,"i");return this.items.filter((e=>e.label.match(t)))}},unmounted(){this.hide&&this.hide.cancel()},components:{Block:F,Search:W,Item:q}}),[["render",function(t,e,r,o,i,a){const c=n.resolveComponent("Search"),s=n.resolveComponent("Block"),l=n.resolveComponent("Item");return n.openBlock(),n.createElementBlock("div",{class:"menu",onMouseover:e[2]||(e[2]=e=>t.hide.cancel()),onMouseleave:e[3]||(e[3]=e=>t.hide.call()),"data-testid":"context-menu","rete-context-menu":""},[t.searchBar?(n.openBlock(),n.createBlock(s,{key:0},{default:n.withCtx((()=>[n.createVNode(c,{text:t.filter,onChange:e[0]||(e[0]=e=>t.filter=e)},null,8,["text"])])),_:1})):n.createCommentVNode("v-if",!0),(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(t.getItems(),(r=>(n.openBlock(),n.createBlock(l,{key:r.key,onSelect:t=>r.handler(t),delay:t.delay,onHide:e[1]||(e[1]=e=>t.onHide()),subitems:r.subitems},{default:n.withCtx((()=>[n.createTextVNode(n.toDisplayString(r.label),1)])),_:2},1032,["onSelect","delay","subitems"])))),128))],32)}],["__scopeId","data-v-2571168d"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/context-menu/components/Menu.vue"]]);var Y=Object.freeze({__proto__:null,setup:function(t){var e=void 0===(null==t?void 0:t.delay)?1e3:t.delay;return{update:function(t){if("contextmenu"===t.data.type)return{items:t.data.items,delay:e,searchBar:t.data.searchBar,onHide:t.data.onHide}},render:function(t){if("contextmenu"===t.data.type)return{component:U,props:{items:t.data.items,delay:e,searchBar:t.data.searchBar,onHide:t.data.onHide}}}}}});function X(t){return"".concat(t,"px")}i(".mini-node[data-v-2d96711d] {\n  position: absolute;\n  background: rgba(110, 136, 255, 0.8);\n  border: 1px solid rgba(192, 206, 212, 0.6);\n}");var J=P({props:["left","top","width","height"],computed:{styles(){return{left:X(this.left),top:X(this.top),width:X(this.width),height:X(this.height)}}}},[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("div",{class:"mini-node",style:n.normalizeStyle(a.styles),"data-testid":"minimap-node"},null,4)}],["__scopeId","data-v-2d96711d"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/minimap/MiniNode.vue"]]);function K(t,e){return{start:function(n){var r=c({},e(n));function o(n){var o=c({},e(n)),i=o.x-r.x,a=o.y-r.y;r=o,t(i,a)}function i(){window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",i),window.removeEventListener("pointercancel",i)}window.addEventListener("pointermove",o),window.addEventListener("pointerup",i),window.addEventListener("pointercancel",i)}}}i(".mini-viewport[data-v-ed5fcf61] {\n  position: absolute;\n  background: rgba(255, 251, 128, 0.32);\n  border: 1px solid #ffe52b;\n}");var Q=P({props:["left","top","width","height","containerWidth","translate"],data(){return{drag:K(this.onDrag,(t=>({x:t.pageX,y:t.pageY})))}},methods:{scale(t){return t*this.containerWidth},invert(t){return t/this.containerWidth},onDrag(t,e){this.translate(this.invert(-t),this.invert(-e))}},computed:{styles(){return{left:X(this.scale(this.left)),top:X(this.scale(this.top)),width:X(this.scale(this.width)),height:X(this.scale(this.height))}}}},[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("div",{class:"mini-viewport",onPointerdown:e[0]||(e[0]=n.withModifiers((t=>i.drag.start(t)),["stop"])),style:n.normalizeStyle(a.styles),"data-testid":"minimap-viewport"},null,36)}],["__scopeId","data-v-ed5fcf61"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/minimap/MiniViewport.vue"]]);i(".minimap[data-v-403730b0] {\n  position: absolute;\n  right: 24px;\n  bottom: 24px;\n  background: rgba(229, 234, 239, 0.65);\n  padding: 20px;\n  overflow: hidden;\n  border: 1px solid #b1b7ff;\n  border-radius: 8px;\n  box-sizing: border-box;\n}");var Z=P({props:{size:Number,ratio:Number,nodes:Array,viewport:Object,translate:Function,point:Function,seed:Number},methods:{dblclick(t){if(!this.$refs.container)return;const e=this.$refs.container.getBoundingClientRect(),n=(t.clientX-e.left)/(this.size*this.ratio),r=(t.clientY-e.top)/(this.size*this.ratio);this.point(n,r)},px:X,scale(t){return this.$refs.container?t*this.$refs.container.clientWidth:0}},components:{MiniNode:J,MiniViewport:Q}},[["render",function(t,e,r,o,i,a){const c=n.resolveComponent("MiniNode"),s=n.resolveComponent("MiniViewport");return n.openBlock(),n.createElementBlock("div",{class:"minimap",ref:"container",style:n.normalizeStyle({width:a.px(r.size*r.ratio),height:a.px(r.size)}),onPointerdown:e[0]||(e[0]=n.withModifiers((()=>{}),["stop","prevent"])),onDblclick:e[1]||(e[1]=n.withModifiers((t=>a.dblclick(t)),["stop","prevent"])),"data-testid":"minimap"},[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.nodes,((t,e)=>(n.openBlock(),n.createBlock(c,{key:[e,t.left].join("_"),left:a.scale(t.left),top:a.scale(t.top),width:a.scale(t.width),height:a.scale(t.height)},null,8,["left","top","width","height"])))),128)),n.createVNode(s,{left:r.viewport.left,top:r.viewport.top,width:r.viewport.width,height:r.viewport.height,containerWidth:t.$refs.container&&t.$refs.container.clientWidth,translate:r.translate},null,8,["left","top","width","height","containerWidth","translate"])],36)}],["__scopeId","data-v-403730b0"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/minimap/Minimap.vue"]]);var tt=Object.freeze({__proto__:null,setup:function(t){return{update:function(e){if("minimap"===e.data.type)return{nodes:e.data.nodes,size:(null==t?void 0:t.size)||200,ratio:e.data.ratio,viewport:e.data.viewport,translate:e.data.translate,point:e.data.point}},render:function(e){if("minimap"===e.data.type)return{component:Z,props:{nodes:e.data.nodes,size:(null==t?void 0:t.size)||200,ratio:e.data.ratio,viewport:e.data.viewport,translate:e.data.translate,point:e.data.point}}}}}});i(".pin[data-v-42b064e9] {\n  width: 20px;\n  height: 20px;\n  box-sizing: border-box;\n  background: steelblue;\n  border: 2px solid white;\n  border-radius: 20px;\n}\n.pin[data-v-42b064e9].selected[data-v-42b064e9] {\n  background: #ffd92c;\n}");const et={class:"pins"};var nt=P({props:["pins","menu","translate","down","seed","getPointer"],components:{Pin:P({props:["position","selected","getPointer"],data(){return{drag:K(this.onDrag,this.getPointer)}},computed:{style(){const{x:t,y:e}=this.position;return{position:"absolute",top:e-10+"px",left:t-10+"px"}}},methods:{onDrag(t,e){this.$emit("translate",{dx:t,dy:e})}}},[["render",function(t,e,r,o,i,a){return n.openBlock(),n.createElementBlock("div",{class:n.normalizeClass(["pin",{selected:r.selected}]),onPointerdown:e[0]||(e[0]=n.withModifiers((e=>{i.drag.start(e),t.$emit("down")}),["stop","prevent"])),onContextmenu:e[1]||(e[1]=n.withModifiers((e=>t.$emit("menu")),["stop","prevent"])),style:n.normalizeStyle(a.style),"data-testid":"pin"},null,38)}],["__scopeId","data-v-42b064e9"],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/reroute/Pin.vue"]])}},[["render",function(t,e,r,o,i,a){const c=n.resolveComponent("Pin");return n.openBlock(),n.createElementBlock("div",et,[(n.openBlock(!0),n.createElementBlock(n.Fragment,null,n.renderList(r.pins,(t=>(n.openBlock(),n.createBlock(c,{key:t.id,position:t.position,selected:t.selected,getPointer:r.getPointer,onMenu:e=>r.menu(t.id),onTranslate:e=>r.translate(t.id,e.dx,e.dy),onDown:e=>r.down(t.id)},null,8,["position","selected","getPointer","onMenu","onTranslate","onDown"])))),128))])}],["__file","/home/runner/work/vue-plugin/vue-plugin/src/presets/reroute/Pins.vue"]]);var rt=Object.freeze({__proto__:null,setup:function(t){var e=function(){return{menu:(null==t?void 0:t.contextMenu)||function(){return null},translate:(null==t?void 0:t.translate)||function(){return null},down:(null==t?void 0:t.pointerdown)||function(){return null}}};return{update:function(t){if("reroute-pins"===t.data.type)return c(c({},e()),{},{pins:t.data.data.pins})},render:function(t,n){if("reroute-pins"===t.data.type){var r=n.parentScope(o.BaseAreaPlugin);return{component:nt,props:c(c({},e()),{},{getPointer:function(){return r.area.pointer},pins:t.data.data.pins})}}}}}}),ot=Object.freeze({__proto__:null,classic:$,contextMenu:Y,minimap:tt,reroute:rt}),it=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&h(t,e)}(i,t);var e,n,r,o=m(i);function i(){var t;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),p(v(t=o.call(this,"vue-render")),"presets",[]),p(v(t),"owners",new WeakMap),t.renderer=k(),t.addPipe((function(e){if(!e||"object"!==l(e)||!("type"in e))return e;if("unmount"===e.type)t.unmount(e.data.element);else if("render"===e.type){if("filled"in e.data&&e.data.filled)return e;if(t.mount(e.data.element,e))return c(c({},e),{},{data:c(c({},e.data),{},{filled:!0})})}return e})),t}return e=i,(n=[{key:"setParent",value:function(t){var e=this;b(f(i.prototype),"setParent",this).call(this,t),this.presets.forEach((function(t){t.attach&&t.attach(e)}))}},{key:"unmount",value:function(t){this.owners.delete(t),this.renderer.unmount(t)}},{key:"mount",value:function(t,e){var n=this,r=this.renderer.get(t),o=this.parentScope();if(r)return this.presets.forEach((function(o){if(n.owners.get(t)===o){var i=o.update(e,n);i&&n.renderer.update(r,i)}})),!0;var i,a=g(this.presets);try{for(a.s();!(i=a.n()).done;){var c=i.value,s=c.render(e,this);if(s)return this.renderer.mount(t,s.component,s.props,(function(){return null==o?void 0:o.emit({type:"rendered",data:e.data})})),this.owners.set(t,c),!0}}catch(t){a.e(t)}finally{a.f()}}},{key:"addPreset",value:function(t){var e=t;e.attach&&e.attach(this),this.presets.push(e)}}])&&d(e.prototype,n),r&&d(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}(e.Scope);t.Presets=ot,t.Ref=j,t.VuePlugin=it,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=rete-vue-plugin.min.js.map
